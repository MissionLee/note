# 联机分析处理

`Online Analytical Processing`

过去,许多企业用关系型数据库存储和管理业务数据,并建立相应的应用系统支持日常的业务运作.这种以支持业务处理为主要目的的,被称为`联机事务处理Online Transaction Processing,OLTP`

随着技术发展,企业更加强调决策的及时性和准确性,使得支持决策管理分析为主要目的的应用迅速崛起,这类应用被称为联机分析处理

## 逻辑概念

- OLAP 展现在用户面前是一幅幅多维视图.维(Dimension):是人们观察数据的特定角度,是考虑问题时的一雷属性,属性集合构成一个维(时间维度,地理纬度).
- 维的层次(Level):观察数据的某个特定角度(即某个维)还可以存在细节程度不同的各个描述(例,时间维:日期,月份,季度,年)
- 维的成员(Member):一个取值
- 度量(Measure):多维数组的取值

## OLAP的基本多维分析操作

`钻取（Drill-up和Drill-down）、切片（Slice）和切块（Dice）、以及旋转（Pivot）等`

- 钻取：是改变维的层次，变换分析的粒度。它包括向下钻取（Drill-down）和向上钻取（Drill-up）/上卷(Roll-up)。Drill-up是在某一维上将低层次的细节数据概括到高层次的汇总数据，或者减少维数；而Drill-down则相反，它从汇总数据深入到细节数据进行观察或增加新维。
- 切片和切块：是在一部分维上选定值后，关心度量数据在剩余维上的分布。如果剩余的维只有两个，则是切片；如果有三个或以上，则是切块。
- 旋转：是变换维的方向，即在表格中重新安排维的放置（例如行列互换）。

## 体系结构编辑

数据仓库与OLAP的关系是互补的，现代`OLAP系统一般以数据仓库作为基础`，即`从数据仓库中抽取详细数据的一个子集并经过必要的聚集存储到OLAP存储器`中供前端分析工具读取。

OLAP系统按照其存储器的数据存储格式可以分为关系OLAP（RelationalOLAP，简称ROLAP）、多维OLAP（MultidimensionalOLAP，简称MOLAP）和混合型OLAP（HybridOLAP，简称HOLAP）三种类型。

- ROLAP

ROLAP将分析用的多维数据存储在关系数据库中并根据应用的需要有选择的定义一批实视图作为表也存储在关系数据库中。不必要将每一个SQL查询都作为实视图保存，只定义那些应用频率比较高、计算工作量比较大的查询作为实视图。对每个针对OLAP服务器的查询，优先利用已经计算好的实视图来生成查询结果以提高查询效率。同时用作ROLAP存储器的RDBMS也针对OLAP作相应的优化，比如并行存储、并行查询、并行数据管理、基于成本的查询优化、位图索引、SQL的OLAP扩展(cube,rollup)等等。

- MOLAP

MOLAP将OLAP分析所用到的多维数据物理上存储为多维数组的形式，形成“立方体”的结构。维的属性值被映射成多维数组的下标值或下标的范围，而总结数据作为多维数组的值存储在数组的单元中。由于MOLAP采用了新的存储结构，从物理层实现起，因此又称为物理OLAP（PhysicalOLAP）；而ROLAP主要通过一些软件工具或中间软件实现，物理层仍采用关系数据库的存储结构，因此称为虚拟OLAP（VirtualOLAP）。

- HOLAP

由于MOLAP和ROLAP有着各自的优点和缺点（如下表所示）,且它们的结构迥然不同，这给分析人员设计OLAP结构提出了难题。为此一个新的OLAP结构——混合型OLAP（HOLAP）被提出，它能把MOLAP和ROLAP两种结构的优点结合起来。迄今为止，对HOLAP还没有一个正式的定义。但很明显，HOLAP结构不应该是MOLAP与ROLAP结构的简单组合，而是这两种结构技术优点的有机结合，能满足用户各种复杂的分析请求。

## 基本功能

- (1)切片和切块(Slice and Dice)\
切片和切块是在维上做投影操作。
切片就是在多维数据上选定一个二维子集的操作，即在某两个维上取一定区间的维成员或全部维成员，而在其余的维上选定一个维成员的操作。
维是观察数据的角度，那么切片的作用或结果就是舍弃一些观察角度，使人们能在两个维上集中观察数据。因为人的空间想象能力毕竟有限，一般很难想象四维以上的空间结构，所以对于维数较多的多维数据空间，数据切片是十分有意义的．
- (2)钻取(Drill)\
钻取有向下钻取(Drill Down)和向上钻取(Drill up)操作。向下钻取是使用户在多层数据中展现渐增的细节层次，获得更多的细节性数据。向上钻取以渐增概括方式汇总数据(例如，从周到季度，再到年度)。
- (3)旋转(Pivoting)\
通过旋转可以得到不同视角的数据。旋转操作相当于在平面内将坐标轴旋转。例如，旋转可能包含了交换行和列，或是把某一个行维移到列维中去，或是把页面显示中的一个维和页面外的维进行交换(令其成为新的行或列中的一个)。

## 广义功能
从广义上讲，任何能够有助于辅助用户理解数据的技术或者操作都可以作为OLAP功能，这些有别于基本OLAP的功能被称为广义OLAP功能。
- (1)基本代理操作
“代理”是一些智能性代理，当系统处于某种特殊状态时提醒分析员。
  - ①示警报告：定义一些条件，一旦条件满足，系统会提醒分析员去做分析。如每日报告完成或月订货完成等通知分析员作分析。
  - ②时间报告：按日历和时钟提醒分析员。
  - ③异常报告：当超出边界条件时提醒分析员。如销售情况已超出预定义阈值的上限或下限时提醒分析员。
- (2)计算能力\
计算引擎用于特定需求的计算或某种复杂计算。
- (3)模型计算\
增加模型，如增加系统优化、统计分析、趋势分析等模型，以提高决策分析能力。


## 联机分析处理的主要特点

`直接仿照用户的多角度思考模式，预先为用户组建多维的数据模型，在这里，维指的是用户的分析角度`。例如对销售数据的分析，时间周期是一个维度，产品类别、分销渠道、地理分布、客户群类也分别是一个维度。一旦多维数据模型建立完成，用户可以快速地从各个分析角度获取数据，也能动态的在各个角度之间切换或者进行多角度综合分析，具有极大的分析灵活性。这也是联机分析处理被广泛关注的根本原因，它从设计理念和真正实现上都与旧有的管理信息系统有着本质的区别。

事实上，随着数据仓库理论的发展，数据仓库系统已逐步成为新型的决策管理信息系统的解决方案。数据仓库系统的核心是联机分析处理，但数据仓库包括更为广泛的内容。

概括来说，数据仓库系统是指具有综合企业数据的能力，能够对大量企业数据进行快速和准确分析，辅助做出更好的商业决策的系统。它本身包括三部分内容：
- 1、数据层：实现对企业操作数据的抽取、转换、清洗和汇总，形成信息数据，并存储在企业级的中心信息数据库中。
- 2、应用层：通过联机分析处理，甚至是数据挖掘等应用处理，实现对信息数据的分析。
- 3、表现层：通过前台分析工具，将查询报表、统计分析、多维联机分析和数据发掘的结论展现在用户面前。

从应用角度来说，数据仓库系统除了联机分析处理外，还可以采用传统的报表，或者采用数理统计和人工智能等数据挖掘手段，涵盖的范围更广；就应用范围而言，联机分析处理往往根据用户分析的主题进行应用分割，例如：销售分析、市场推广分析、客户利润率分析等等，每一个分析的主题形成一个OLAP应用，而`所有的OLAP应用实际上只是数据仓库系统的一部分`