# 事实表设计

## 基础

- 事实表特性

    一条记录所表达的业务细节成为粒度,粒度通常用两种方式来表述

  - 1.维度属性组合所表示的细节程度
  - 2.所表示的具体业务含义

    事实表有三种类型

  - 事务事实表:描述业务过程
  - 周期快照事实表:规律时间点
  - 累积快照事实表:关键时间点
- 事实表设计原则
  - 尽可能包含所有与业务过程相关的实时
  - 只选择与业务过程相关的实时
  - 分解不可加性事实为可加性组件:八折具体成优惠金额
  - 在选择维度和事实之间必须先声明粒度
  - 在同一个事实表中,不能有多种不同粒度的事实
  - 事实的单位要保持一致
  - 对事实的null值要处理:`对事实表中,事实度量为null的值要处理,一般用0填充,因为null的情况下大于小于这种过滤都不生效`
  - 使用退化维度提高事实表的易用性
- 事实表设计方法
  - 选择业务过程,确定事实表类型
  - 声明粒度
  - 确定维度
  - 确定事实
  - 冗余维度

## 事务事实表

- 设计过程:在上方
- 单事务事实表:每个业务过程设计一个事实表
- 多事务事实表:
- 两种事实表对比
- 父子事实的处理方式
- 事实的设计准测
  - 事实的完整性
  - 事实一致性
  - 事实可加性

## 周期快照事务表

## 累积快照事务表

## 三种事务表的比较

## 无事实的事实表

    行为日志之类的

## 聚集型事务表

    主要通过汇总明细粒度数据,来获得改进查询性能的效果,快速响应查询

- 聚集的基本原则
  - 一致性
  - 避免单一表设计:不要在同一个表中存储不同层次的聚集数据,否则会导致双重计算甚至更坏的结果.
  - 聚集粒度可不同